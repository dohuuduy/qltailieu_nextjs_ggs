const { google } = require('googleapis');

async function addSampleData() {
    try {
        console.log('üîÑ ƒêang th√™m d·ªØ li·ªáu m·∫´u v√†o Google Sheets...');

        const auth = new google.auth.GoogleAuth({
            credentials: {
                client_email: 'qltailieu-nextjs@qltailieu-nextjs.iam.gserviceaccount.com',
                private_key: `-----BEGIN PRIVATE KEY-----
MIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQDDbp4j1pQs5zjY
ggjkjyH4yXF52dLjSr8I1bLU0FllqeQiH/AKj10H4RKX2qei25W0L8Mjrb4Sqjho
b2LSmPGywcxTyYEzDNf8GWDl4guUCmecCILmmObVCps+VdwPkh5at4RvUXo4yP8R
xKZwnc1/829hnj7w0w6ydm9g5ju85PtF0vJRFoqF0OZvQ7clc+cRPuNqs1MwXQK9
4ufNvCeX+w4hhS1wuCyOhDxRTu1pSIx0VWKzrfeHl4+mHNa/6v0+Er6lmg+LJtWL
WTcZxD4g6aVsO+HqSKiQCJz9Rztz1HRAu356KIVl6hTKcX8eVNFqGOXzK//vX73j
9qupUr6nAgMBAAECggEAXQ1b7bt7VQAJQIl1u4HtTnx38+lDsOaDnCzIF+1WS4I/
dgIX9Kc7SAeiJzy8qd38400EkIXm5RM4hX1Xo+ef2ZnN9K0Sv+BjLI1W5k4hbi0g
FRq2XR67df+1WFJgU+eiXVZZD/nPBJ+rV2X3S9LPKJeb1nKXDGqp6k5bDNvC4Naf
CAbX1RDFD/i5uztdX0Aju5rOrbMgkMGLh3Bgs2IQGR8kZgmMh1o0kyWc6/btqxBi
NmGE6Q3zunFEAEeP6yZiToZKInZcAXKBNaIJm/ZyC9F1jzhRfr3mt1xHXg2IxRyK
s0CAHLLk03D2rout4waHigVF3Tqs1qdaqVENudofFQKBgQDrYOhE++ki7Z8g4uk8
CGb3Da+TandfNeOxcISY+rJZodmMF4osEeC7yd3Bi2ysI0U3JAyjBDW8V1wvn7im
z6RRme+KZPMWNz+izfhb2JTNGfJD5vS98JkqQeuMcL6kWLZtVAWiXsx6Lv2nW/jY
mCZlrlCk9ArA+CzAmn+B1z62uwKBgQDUjcmpVYRZWbkeYpDcIvDdIWnkWUPWxfjK
0Kk2f15CnKDDZwalbf8WL34rP1YTwhB/kejkOJmHWLO5LDo48ulApFeBznUdXof/
kyFOhSJQrDwZIr/gUBP4tsvA49lUsZysQqx85w4knpHfDlvu4ZpJKFetG7ELTXyX
tVufU5U3BQKBgDvFNfYeigsmkBwHwvZNo+fkf8tNY9a3loQ+cE1wi82a/eVHLP0X
5RuKnVdCkmv74N2pt9PFg+e5v10QkBE79RwLnPplvBzOFsi+yOx5yP90MULw6QE6
kYpbhvb4wlB1fo2womWi8QWt3ReckUpfCJEVfMEGf5yU6LhYAzzzbad1AoGAPd5X
iJZ/w5I+M/30tF7nRTZooDLrcCSH2mEKH/bK9RCqKrZeVODDky2Xx/bTk0S1kKxj
4aon5iGHjqq098ac5lfvsLTrmfTeGSI2W6ic6GZ5x8c5mo00gvySKj8oD2Lze6Cc
nG6Uy0vsocSINewtAIZhnt2klumjDnWXibTGhhECgYAeN4CTilF6z1+RMyv0skVb
BoH8k/6S5BgeGT6/O56cxYQDJcsSgtkF/7O6Sgvds763+ggY5ouPUFscH48zOiaD
uh6OP8ULZeWgb3ug43c3kcZYZ6t/L2H8fULRmg/C3seyROyrrjcBgqXUyk+6hZct
Y4O9x/7lczTx3gHFmnMHEw==
-----END PRIVATE KEY-----`,
            },
            scopes: [
                'https://www.googleapis.com/auth/spreadsheets',
                'https://www.googleapis.com/auth/drive.file'
            ],
        });

        const sheets = google.sheets({ version: 'v4', auth });
        const spreadsheetId = '11auJkhP6TtJJUq84BaeIHRa5NpE_8IX9CX_nj_pyjcc';

        // D·ªØ li·ªáu m·∫´u cho t·ª´ng b·∫£ng
        const sampleData = {
            tai_lieu: {
                headers: ['id', 'ten_tai_lieu', 'mo_ta', 'loai_tai_lieu', 'trang_thai', 'nguoi_tao', 'ngay_tao', 'nguoi_cap_nhat', 'ngay_cap_nhat', 'phien_ban_hien_tai', 'tieu_chuan_ap_dung'],
                data: [
                    ['1', 'Quy tr√¨nh ki·ªÉm tra ch·∫•t l∆∞·ª£ng s·∫£n ph·∫©m', 'T√†i li·ªáu m√¥ t·∫£ quy tr√¨nh ki·ªÉm tra ch·∫•t l∆∞·ª£ng cho t·∫•t c·∫£ s·∫£n ph·∫©m', 'quy_trinh', 'hieu_luc', 'Nguy·ªÖn VƒÉn A', '2024-01-15', 'Nguy·ªÖn VƒÉn A', '2024-03-01', '2.1', 'ISO 9001:2015'],
                    ['2', 'H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng h·ªá th·ªëng ERP', 'T√†i li·ªáu h∆∞·ªõng d·∫´n chi ti·∫øt c√°ch s·ª≠ d·ª•ng h·ªá th·ªëng ERP', 'huong_dan', 'hieu_luc', 'Tr·∫ßn Th·ªã B', '2024-02-01', 'Tr·∫ßn Th·ªã B', '2024-02-01', '1.0', 'N·ªôi b·ªô'],
                    ['3', 'Quy tr√¨nh x·ª≠ l√Ω khi·∫øu n·∫°i kh√°ch h√†ng', 'T√†i li·ªáu m√¥ t·∫£ quy tr√¨nh ti·∫øp nh·∫≠n v√† x·ª≠ l√Ω khi·∫øu n·∫°i t·ª´ kh√°ch h√†ng', 'quy_trinh', 'hieu_luc', 'L√™ VƒÉn C', '2024-01-20', 'L√™ VƒÉn C', '2024-02-10', '1.2', 'ISO 9001:2015'],
                    ['4', 'Bi·ªÉu m·∫´u ƒë√°nh gi√° nh√† cung c·∫•p', 'Bi·ªÉu m·∫´u ƒë√°nh gi√° v√† l·ª±a ch·ªçn nh√† cung c·∫•p', 'bieu_mau', 'hieu_luc', 'Ph·∫°m Th·ªã D', '2024-02-05', 'Ph·∫°m Th·ªã D', '2024-02-05', '1.0', 'N·ªôi b·ªô'],
                    ['5', 'H∆∞·ªõng d·∫´n b·∫£o tr√¨ thi·∫øt b·ªã', 'T√†i li·ªáu h∆∞·ªõng d·∫´n b·∫£o tr√¨ ƒë·ªãnh k·ª≥ c√°c thi·∫øt b·ªã s·∫£n xu·∫•t', 'tai_lieu_ky_thuat', 'hieu_luc', 'Ho√†ng VƒÉn E', '2024-01-10', 'Ho√†ng VƒÉn E', '2024-02-20', '1.1', 'ISO 14001:2015']
                ]
            },
            phien_ban: {
                headers: ['id', 'tai_lieu_id', 'so_phien_ban', 'noi_dung', 'ghi_chu', 'nguoi_tao', 'ngay_tao', 'trang_thai'],
                data: [
                    ['1', '1', '2.1', 'C·∫≠p nh·∫≠t quy tr√¨nh ki·ªÉm tra theo ti√™u chu·∫©n m·ªõi', 'Th√™m b∆∞·ªõc ki·ªÉm tra b·ªï sung', 'Nguy·ªÖn VƒÉn A', '2024-03-01', 'hieu_luc'],
                    ['2', '1', '2.0', 'C·∫≠p nh·∫≠t quy tr√¨nh theo y√™u c·∫ßu kh√°ch h√†ng', 'ƒêi·ªÅu ch·ªânh th·ªùi gian ki·ªÉm tra', 'Nguy·ªÖn VƒÉn A', '2024-02-15', 'het_hieu_luc'],
                    ['3', '1', '1.0', 'Phi√™n b·∫£n ƒë·∫ßu ti√™n c·ªßa quy tr√¨nh ki·ªÉm tra', 'T√†i li·ªáu ƒë∆∞·ª£c t·∫°o m·ªõi', 'Nguy·ªÖn VƒÉn A', '2024-01-15', 'het_hieu_luc'],
                    ['4', '2', '1.0', 'Phi√™n b·∫£n ƒë·∫ßu ti√™n c·ªßa h∆∞·ªõng d·∫´n ERP', 'T√†i li·ªáu ƒë∆∞·ª£c t·∫°o m·ªõi', 'Tr·∫ßn Th·ªã B', '2024-02-01', 'hieu_luc'],
                    ['5', '3', '1.2', 'C·∫≠p nh·∫≠t quy tr√¨nh x·ª≠ l√Ω khi·∫øu n·∫°i', 'Th√™m b∆∞·ªõc theo d√µi sau x·ª≠ l√Ω', 'L√™ VƒÉn C', '2024-02-10', 'hieu_luc'],
                    ['6', '3', '1.1', 'ƒêi·ªÅu ch·ªânh th·ªùi gian x·ª≠ l√Ω', 'R√∫t ng·∫Øn th·ªùi gian ph·∫£n h·ªìi', 'L√™ VƒÉn C', '2024-01-25', 'het_hieu_luc'],
                    ['7', '3', '1.0', 'Phi√™n b·∫£n ƒë·∫ßu ti√™n', 'T√†i li·ªáu ƒë∆∞·ª£c t·∫°o m·ªõi', 'L√™ VƒÉn C', '2024-01-20', 'het_hieu_luc'],
                    ['8', '4', '1.0', 'Phi√™n b·∫£n ƒë·∫ßu ti√™n c·ªßa bi·ªÉu m·∫´u', 'T√†i li·ªáu ƒë∆∞·ª£c t·∫°o m·ªõi', 'Ph·∫°m Th·ªã D', '2024-02-05', 'hieu_luc'],
                    ['9', '5', '1.1', 'C·∫≠p nh·∫≠t h∆∞·ªõng d·∫´n b·∫£o tr√¨', 'Th√™m thi·∫øt b·ªã m·ªõi', 'Ho√†ng VƒÉn E', '2024-02-20', 'hieu_luc'],
                    ['10', '5', '1.0', 'Phi√™n b·∫£n ƒë·∫ßu ti√™n', 'T√†i li·ªáu ƒë∆∞·ª£c t·∫°o m·ªõi', 'Ho√†ng VƒÉn E', '2024-01-10', 'het_hieu_luc']
                ]
            },
            lich_su: {
                headers: ['id', 'tai_lieu_id', 'phien_ban_id', 'hanh_dong', 'mo_ta', 'nguoi_thuc_hien', 'ngay_thuc_hien'],
                data: [
                    ['1', '1', '1', 'cap_nhat_phien_ban', 'T·∫°o phi√™n b·∫£n 2.1: C·∫≠p nh·∫≠t quy tr√¨nh ki·ªÉm tra theo ti√™u chu·∫©n m·ªõi', 'Nguy·ªÖn VƒÉn A', '2024-03-01'],
                    ['2', '1', '2', 'cap_nhat_phien_ban', 'T·∫°o phi√™n b·∫£n 2.0: C·∫≠p nh·∫≠t quy tr√¨nh theo y√™u c·∫ßu kh√°ch h√†ng', 'Nguy·ªÖn VƒÉn A', '2024-02-15'],
                    ['3', '1', '3', 'tao_moi', 'T·∫°o t√†i li·ªáu m·ªõi: Quy tr√¨nh ki·ªÉm tra ch·∫•t l∆∞·ª£ng s·∫£n ph·∫©m', 'Nguy·ªÖn VƒÉn A', '2024-01-15'],
                    ['4', '2', '4', 'tao_moi', 'T·∫°o t√†i li·ªáu m·ªõi: H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng h·ªá th·ªëng ERP', 'Tr·∫ßn Th·ªã B', '2024-02-01'],
                    ['5', '3', '5', 'cap_nhat_phien_ban', 'T·∫°o phi√™n b·∫£n 1.2: C·∫≠p nh·∫≠t quy tr√¨nh x·ª≠ l√Ω khi·∫øu n·∫°i', 'L√™ VƒÉn C', '2024-02-10'],
                    ['6', '3', '6', 'cap_nhat_phien_ban', 'T·∫°o phi√™n b·∫£n 1.1: ƒêi·ªÅu ch·ªânh th·ªùi gian x·ª≠ l√Ω', 'L√™ VƒÉn C', '2024-01-25'],
                    ['7', '3', '7', 'tao_moi', 'T·∫°o t√†i li·ªáu m·ªõi: Quy tr√¨nh x·ª≠ l√Ω khi·∫øu n·∫°i kh√°ch h√†ng', 'L√™ VƒÉn C', '2024-01-20'],
                    ['8', '4', '8', 'tao_moi', 'T·∫°o t√†i li·ªáu m·ªõi: Bi·ªÉu m·∫´u ƒë√°nh gi√° nh√† cung c·∫•p', 'Ph·∫°m Th·ªã D', '2024-02-05'],
                    ['9', '5', '9', 'cap_nhat_phien_ban', 'T·∫°o phi√™n b·∫£n 1.1: C·∫≠p nh·∫≠t h∆∞·ªõng d·∫´n b·∫£o tr√¨', 'Ho√†ng VƒÉn E', '2024-02-20'],
                    ['10', '5', '10', 'tao_moi', 'T·∫°o t√†i li·ªáu m·ªõi: H∆∞·ªõng d·∫´n b·∫£o tr√¨ thi·∫øt b·ªã', 'Ho√†ng VƒÉn E', '2024-01-10']
                ]
            },
            tieu_chuan: {
                headers: ['id', 'ten_tieu_chuan', 'ma_tieu_chuan', 'mo_ta', 'phien_ban', 'ngay_ban_hanh', 'trang_thai'],
                data: [
                    ['1', 'ISO 9001:2015', 'ISO9001-2015', 'H·ªá th·ªëng qu·∫£n l√Ω ch·∫•t l∆∞·ª£ng - Y√™u c·∫ßu', '2015', '2015-09-15', 'hieu_luc'],
                    ['2', 'ISO 14001:2015', 'ISO14001-2015', 'H·ªá th·ªëng qu·∫£n l√Ω m√¥i tr∆∞·ªùng - Y√™u c·∫ßu', '2015', '2015-09-15', 'hieu_luc'],
                    ['3', 'ISO 45001:2018', 'ISO45001-2018', 'H·ªá th·ªëng qu·∫£n l√Ω an to√†n v√† s·ª©c kh·ªèe ngh·ªÅ nghi·ªáp', '2018', '2018-03-12', 'hieu_luc'],
                    ['4', 'Ti√™u chu·∫©n n·ªôi b·ªô', 'NOI-BO-001', 'Ti√™u chu·∫©n quy tr√¨nh n·ªôi b·ªô c√¥ng ty', '1.0', '2024-01-01', 'hieu_luc'],
                    ['5', 'TCVN 5687:2010', 'TCVN5687-2010', 'Ti√™u chu·∫©n Vi·ªát Nam v·ªÅ ch·∫•t l∆∞·ª£ng s·∫£n ph·∫©m', '2010', '2010-12-01', 'hieu_luc']
                ]
            },
            file_dinh_kem: {
                headers: ['id', 'tai_lieu_id', 'phien_ban_id', 'ten_file', 'duong_dan', 'kich_thuoc', 'loai_file', 'ngay_tai_len'],
                data: [
                    ['1', '1', '1', 'quy-trinh-kiem-tra-v2.1.pdf', '/files/quy-trinh-kiem-tra-v2.1.pdf', '2.5MB', 'pdf', '2024-03-01'],
                    ['2', '1', '1', 'bieu-mau-kiem-tra.xlsx', '/files/bieu-mau-kiem-tra.xlsx', '1.2MB', 'xlsx', '2024-03-01'],
                    ['3', '2', '4', 'huong-dan-erp.pdf', '/files/huong-dan-erp.pdf', '5.8MB', 'pdf', '2024-02-01'],
                    ['4', '2', '4', 'video-huong-dan.mp4', '/files/video-huong-dan.mp4', '125MB', 'mp4', '2024-02-01'],
                    ['5', '3', '5', 'quy-trinh-khieu-nai-v1.2.docx', '/files/quy-trinh-khieu-nai-v1.2.docx', '850KB', 'docx', '2024-02-10'],
                    ['6', '4', '8', 'bieu-mau-danh-gia-ncc.xlsx', '/files/bieu-mau-danh-gia-ncc.xlsx', '450KB', 'xlsx', '2024-02-05'],
                    ['7', '5', '9', 'huong-dan-bao-tri-v1.1.pdf', '/files/huong-dan-bao-tri-v1.1.pdf', '3.2MB', 'pdf', '2024-02-20'],
                    ['8', '5', '9', 'lich-bao-tri.xlsx', '/files/lich-bao-tri.xlsx', '680KB', 'xlsx', '2024-02-20']
                ]
            },
            loai_tai_lieu: {
                headers: ['id', 'ma_loai', 'ten_loai', 'mo_ta', 'mau_sac', 'thu_tu'],
                data: [
                    ['1', 'quy_trinh', 'Quy Tr√¨nh', 'T√†i li·ªáu quy tr√¨nh l√†m vi·ªác', 'blue', '1'],
                    ['2', 'huong_dan', 'H∆∞·ªõng D·∫´n', 'T√†i li·ªáu h∆∞·ªõng d·∫´n s·ª≠ d·ª•ng', 'green', '2'],
                    ['3', 'tai_lieu_ky_thuat', 'T√†i Li·ªáu K·ªπ Thu·∫≠t', 'T√†i li·ªáu k·ªπ thu·∫≠t chuy√™n m√¥n', 'purple', '3'],
                    ['4', 'bieu_mau', 'Bi·ªÉu M·∫´u', 'C√°c bi·ªÉu m·∫´u, form', 'orange', '4'],
                    ['5', 'chinh_sach', 'Ch√≠nh S√°ch', 'T√†i li·ªáu ch√≠nh s√°ch c√¥ng ty', 'red', '5']
                ]
            },
            trang_thai: {
                headers: ['id', 'ma_trang_thai', 'ten_trang_thai', 'mo_ta', 'mau_sac', 'thu_tu'],
                data: [
                    ['1', 'hieu_luc', 'Hi·ªáu L·ª±c', 'T√†i li·ªáu ƒëang c√≥ hi·ªáu l·ª±c', 'green', '1'],
                    ['2', 'het_hieu_luc', 'H·∫øt Hi·ªáu L·ª±c', 'T√†i li·ªáu ƒë√£ h·∫øt hi·ªáu l·ª±c', 'red', '2'],
                    ['3', 'ban_nhap', 'B·∫£n Nh√°p', 'T√†i li·ªáu ƒëang so·∫°n th·∫£o', 'yellow', '3'],
                    ['4', 'cho_duyet', 'Ch·ªù Duy·ªát', 'T√†i li·ªáu ch·ªù ph√™ duy·ªát', 'blue', '4'],
                    ['5', 'tam_ngung', 'T·∫°m Ng∆∞ng', 'T√†i li·ªáu t·∫°m th·ªùi ng∆∞ng s·ª≠ d·ª•ng', 'orange', '5']
                ]
            }
        };

        // X√≥a d·ªØ li·ªáu c≈© v√† th√™m headers + d·ªØ li·ªáu m·ªõi cho t·ª´ng sheet
        for (const [sheetName, sheetData] of Object.entries(sampleData)) {
            console.log(`üìù ƒêang x·ª≠ l√Ω sheet: ${sheetName}`);

            try {
                // X√≥a d·ªØ li·ªáu c≈© (gi·ªØ l·∫°i headers)
                await sheets.spreadsheets.values.clear({
                    spreadsheetId,
                    range: `${sheetName}!A:Z`,
                });

                // Th√™m headers
                await sheets.spreadsheets.values.update({
                    spreadsheetId,
                    range: `${sheetName}!A1:${String.fromCharCode(65 + sheetData.headers.length - 1)}1`,
                    valueInputOption: 'USER_ENTERED',
                    requestBody: {
                        values: [sheetData.headers],
                    },
                });

                // Th√™m d·ªØ li·ªáu
                if (sheetData.data.length > 0) {
                    await sheets.spreadsheets.values.append({
                        spreadsheetId,
                        range: `${sheetName}!A:Z`,
                        valueInputOption: 'USER_ENTERED',
                        requestBody: {
                            values: sheetData.data,
                        },
                    });
                }

                console.log(`‚úÖ ƒê√£ th√™m ${sheetData.data.length} d√≤ng d·ªØ li·ªáu v√†o sheet ${sheetName}`);
            } catch (error) {
                console.error(`‚ùå L·ªói khi x·ª≠ l√Ω sheet ${sheetName}:`, error.message);
            }
        }

        console.log('\nüéâ Ho√†n th√†nh th√™m d·ªØ li·ªáu m·∫´u!');
        console.log('üìä T·ªïng k·∫øt:');
        console.log(`- ${sampleData.tai_lieu.data.length} t√†i li·ªáu`);
        console.log(`- ${sampleData.phien_ban.data.length} phi√™n b·∫£n`);
        console.log(`- ${sampleData.lich_su.data.length} l·ªãch s·ª≠ thay ƒë·ªïi`);
        console.log(`- ${sampleData.tieu_chuan.data.length} ti√™u chu·∫©n`);
        console.log(`- ${sampleData.file_dinh_kem.data.length} file ƒë√≠nh k√®m`);
        console.log(`- ${sampleData.loai_tai_lieu.data.length} lo·∫°i t√†i li·ªáu`);
        console.log(`- ${sampleData.trang_thai.data.length} tr·∫°ng th√°i`);
        console.log(`\nüîó Truy c·∫≠p: https://docs.google.com/spreadsheets/d/${spreadsheetId}`);

        return true;
    } catch (error) {
        console.error('‚ùå L·ªói khi th√™m d·ªØ li·ªáu m·∫´u:', error);
        return false;
    }
}

// Ch·∫°y script
if (require.main === module) {
    addSampleData()
        .then((success) => {
            console.log(success ? '\n‚úÖ Th√™m d·ªØ li·ªáu m·∫´u th√†nh c√¥ng!' : '\nüí• Th√™m d·ªØ li·ªáu m·∫´u th·∫•t b·∫°i!');
            process.exit(success ? 0 : 1);
        })
        .catch((error) => {
            console.error('üí• L·ªói kh√¥ng mong ƒë·ª£i:', error);
            process.exit(1);
        });
}

module.exports = { addSampleData };